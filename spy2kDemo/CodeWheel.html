<!DOCTYPE html>
<html lang="en-ca">
	<head>
		<meta charset="utf-8" />
		<title>Code Wheel Cipher</title>
		<script src="cipher.js"></script>
		<script>
			var increment = 360 / 26.0;
			var Button = {Left : 0, Right : 2 };
			
			var cipherText = "";
			var offset = 0;

			var debugMode = false;

			function rotate(img, e) 
			{
				var r = parseFloat(img.style.transform.replace("rotate(", "").replace(")", ""));

				if (e.button == Button.Right)  r = r + increment;
				else if(e.button == Button.Left)  r = r - increment;

				if (r < 0) r = 360 - Math.abs(r);
				else if (r >= 360)  r = r - 360;

				img.style.transform = "rotate(" + r + "deg)";

				var letter = String.fromCharCode(25 - Math.floor(r / 360.0 * 26) + 65);
				offset = letter.charCodeAt(0) - "A".charCodeAt(0);

				if(debugMode)
				{
					document.querySelector("#rot").innerHTML = Math.floor(r);
					document.querySelector("#let").innerHTML = letter;
					document.querySelector("#off").innerHTML = offset;
				}

				routeCipher(false);
			}	
			
			window.onload = function()
			{
				cipherText = document.querySelector("#message").innerText;
				document.querySelector("#debug").style.display = (debugMode ? "" : "none");
			};
		</script>
		<style>
			body { font-family:Arial; }
			div { position:relative;height:354px;width:349px; }
			div img { position:absolute; }
			#imgIn { z-index:100;left:calc(50% - 263px / 2);top:calc(50% - 267px / 2) }
			#imgOut { z-index:99;top:0;left:0;transform:rotate(-5deg) }
			#message { white-space:preserve;margin:20px;padding:10px;font-family:monospace;height:auto;width:400px;background-color:#E2E2E2;font-size:13pt; }
			div { display:inline-block;vertical-align:top; }
		</style>
	</head>
	<body>
		<div id="wheel">
			<img id="imgIn" src="innerWheel.png" style="transform:rotate(-5deg)" onmousedown="rotate(this,event)" oncontextmenu="return false" />
			<img id="imgOut" src="outerWheel.png" />
		</div>

		<div id="debug" style="display:none">
			<strong>Inner Rotation:</strong> <span id="rot">0</span>&deg;<br />
			<strong>Inner Letter:</strong> <span id="let">A</span><br />
			<strong>Offset:</strong> <span id="off">0</span>
		</div>

		<div id="message">
6ur brn4 v5 emml n0q 6rpu01y1tb n0q 6ur o75v0r55r5 6un6 4ryb 10 v6 n4r o11zv0t n6 6ur s14rs4106 1s 6uv5 uvtu6rpu 914yq 4r5vqr5 n t4rn6 0146ur40 p17064b svyyrq 9v6u znwr56vp 9vyqyvsr 524n9yv0t pv6vr5 n0q n0 no70qn0pr 1s 18r4n21y1tr6vp pv6vcr05 10 6ur p766v0t rqtr 1s 6uv5 p17064b5 nq8n0przr06 n4r 5r8r4ny nyyp1057zv0t p14214n6v105 6ur 6rpu zn07snp674r4 5yn22yr 6ur n22yvn0pr p1z2n0b st 6ur on0xv0t p10ty1zr4n6r p0o 6ur 6ryrp1z p1z2n0b q41615 p1zz70vpn6v105 n0q 6ur 5unq19b 14tn0vcn6v10 x0190 n5 6ur oynpx9ro py756r4 v0 6ur zvq56 1s 6uv5 0146ur40 p14214n6r 2n4nqv5r 6ur5r p1z2n0vr5 5vz7y6n0r175yb znxr n 6r44voyr qv5p18r4b 6urv4 5b56rz5 q1 016 5722146 qn6r5 2n56 emmm n0q v056rnq 1s t1v0t 61 6ur brn4 fddd 6urb 917yq v056rnq 41yy 18r4 onpx 61 6ur brn4 emdd vs 6uv5 v557r v5 016 4r51y8rq nyy zn00r4 1s pun15 917yq r057r 6rpu01y1tb 917yq 4rt4r55 edd brn4 nyy 6ur z10rb v0 nyy 6ur on0x5 v0 6ur 914yq 917yq 59n2 4n0q1zyb n0q u175ru1yq n22yvn0pr5 917yq 52106n0r175yb p1zo756 61 24r8r06 6uv5 n21pnyb25r rnpu p1z2n0b p1zzv65 61 nqn26v0t 6urv4 5b56rz5 s14 6ur p1zv0t zvyyr00vn u19r8r4 r8r0 n4zntrqq10 q1r5 016 1769rvtu 2412r4 o75v0r55 24np6vpr n0q 01 np67ny 914x pn0 or q10r 706vy zn4xr6 4r5rn4pu v5 p1z2yr6rq 
		</div>
	</body>
</html>